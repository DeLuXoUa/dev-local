server {
        listen 80 default_server;
        index index.php;
        server_name dev2.omnismain.com;
        error_log  /var/log/nginx/error.log;
        access_log /var/log/nginx/access.log;
        root /var/www/ssyii/web;

        set $yii_bootstrap "index.php";

	location ~ /.well-known {
	  allow all;
	}

	location /rest/ {
                index  index.html $yii_bootstrap;
                try_files $uri $uri/ /$yii_bootstrap?$args;
	}

	location /ss/ {
		alias /var/www/ssfront/dist/;
		autoindex off;
	}

        location / {
        proxy_pass http://192.168.1.52:1111;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_redirect off;
        }

        location /site {
                index  index.html $yii_bootstrap;
                try_files $uri $uri/ /$yii_bootstrap?$args;
        }


        location /vue/ {
                proxy_pass http://localhost:1111;
        }

	location = /app.js {
        	proxy_pass http://192.168.1.52:1111/app.js;
	}


        location ~ ^/(protected|framework|themes/\w+/views) {
                deny  all;
        }


        location ~ \.(js|css|png|jpg|gif|swf|ico|pdf|mov|fla|zip|rar)$ {
                try_files $uri =404;
        }

        location ~ \.php$ {
                try_files $uri =404;
                fastcgi_split_path_info ^(.+\.php)(/.+)$;
                fastcgi_pass fpm:9000;
                fastcgi_index index.php;
                include fastcgi_params;
                fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
                fastcgi_param PATH_INFO $fastcgi_path_info;
        }

        location ~ /\. {
                deny all;
                access_log off;
                log_not_found off;
        }
}
